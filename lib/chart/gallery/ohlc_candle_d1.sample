data = [
  { ~N[2016-02-17 00:00:00], 1898.8, 1930.68, 1898.8, 1926.82, 2784188889},
  { ~N[2016-02-18 00:00:00], 1927.57, 1930, 1915.09, 1917.83, 2464716667},
  { ~N[2016-02-19 00:00:00], 1916.74, 1918.78, 1902.17, 1917.78, 2301583333},
  { ~N[2016-02-22 00:00:00], 1924.44, 1946.7, 1924.44, 1945.5, 2252616667},
  { ~N[2016-02-23 00:00:00], 1942.38, 1942.38, 1919.44, 1921.27, 2161472222},
  { ~N[2016-02-24 00:00:00], 1917.56, 1932.08, 1891, 1929.8, 2398472222},
  { ~N[2016-02-25 00:00:00], 1931.87, 1951.83, 1925.41, 1951.7, 2287894444},
  { ~N[2016-02-26 00:00:00], 1954.95, 1962.96, 1945.78, 1948.05, 2415838889},
  { ~N[2016-02-29 00:00:00], 1947.13, 1958.27, 1931.81, 1932.23, 2548988889},
  { ~N[2016-03-01 00:00:00], 1937.09, 1978.35, 1937.09, 1978.35, 2677638889},
  { ~N[2016-03-02 00:00:00], 1976.6, 1986.51, 1968.8, 1986.45, 2592561111},
  { ~N[2016-03-03 00:00:00], 1985.6, 1993.69, 1977.37, 1993.4, 2823166667},
  { ~N[2016-03-04 00:00:00], 1994.01, 2009.13, 1986.77, 1999.99, 3361072222},
  { ~N[2016-03-07 00:00:00], 1996.11, 2006.12, 1989.38, 2001.76, 2760100000},
  { ~N[2016-03-08 00:00:00], 1996.88, 1996.88, 1977.43, 1979.26, 2578694444},
  { ~N[2016-03-09 00:00:00], 1981.44, 1992.69, 1979.84, 1989.26, 2243400000},
  { ~N[2016-03-10 00:00:00], 1990.97, 2005.08, 1969.25, 1989.57, 2431550000},
  { ~N[2016-03-11 00:00:00], 1994.71, 2022.37, 1994.71, 2022.19, 2265900000},
  { ~N[2016-03-14 00:00:00], 2019.27, 2024.57, 2012.05, 2019.64, 1937694444},
  { ~N[2016-03-15 00:00:00], 2015.27, 2015.94, 2005.23, 2015.93, 1977933333},
  { ~N[2016-03-16 00:00:00], 2014.24, 2032.02, 2010.04, 2027.22, 2253900000},
  { ~N[2016-03-17 00:00:00], 2026.9, 2046.24, 2022.16, 2040.59, 2516933333},
  { ~N[2016-03-18 00:00:00], 2041.16, 2052.36, 2041.16, 2049.58, 3612855556},
  { ~N[2016-03-21 00:00:00], 2047.88, 2053.91, 2043.14, 2051.6, 1875888889},
  { ~N[2016-03-22 00:00:00], 2048.64, 2056.6, 2040.57, 2049.8, 1899144444},
  { ~N[2016-03-23 00:00:00], 2048.55, 2048.55, 2034.86, 2036.71, 2021950000},
  { ~N[2016-03-24 00:00:00], 2032.48, 2036.04, 2022.49, 2035.94, 1893177778},
  { ~N[2016-03-28 00:00:00], 2037.89, 2042.67, 2031.96, 2037.05, 1560605556},
  { ~N[2016-03-29 00:00:00], 2035.75, 2055.91, 2028.31, 2055.01, 2123516667},
  { ~N[2016-03-30 00:00:00], 2058.27, 2072.21, 2058.27, 2063.95, 1994616667},
  { ~N[2016-03-31 00:00:00], 2063.77, 2067.92, 2057.46, 2059.74, 2064044444},
  { ~N[2016-04-01 00:00:00], 2056.62, 2075.07, 2043.98, 2072.78, 2083327778},
  { ~N[2016-04-04 00:00:00], 2073.19, 2074.02, 2062.57, 2066.13, 1936505556},
  { ~N[2016-04-05 00:00:00], 2062.5, 2062.5, 2042.56, 2045.17, 2308288889},
  { ~N[2016-04-06 00:00:00], 2045.56, 2067.33, 2043.09, 2066.66, 2083777778},
  { ~N[2016-04-07 00:00:00], 2063.01, 2063.01, 2033.8, 2041.91, 2111805556},
  { ~N[2016-04-08 00:00:00], 2045.54, 2060.63, 2041.69, 2047.6, 1866405556},
  { ~N[2016-04-11 00:00:00], 2050.23, 2062.93, 2041.88, 2041.99, 1982133333},
  { ~N[2016-04-12 00:00:00], 2043.72, 2065.05, 2039.74, 2061.72, 2355411111},
  { ~N[2016-04-13 00:00:00], 2065.92, 2083.18, 2065.92, 2082.42, 2328794444},
  { ~N[2016-04-14 00:00:00], 2082.89, 2087.84, 2078.13, 2082.78, 2092150000},
  { ~N[2016-04-15 00:00:00], 2083.1, 2083.22, 2076.31, 2080.73, 2056361111},
  { ~N[2016-04-18 00:00:00], 2078.83, 2094.66, 2073.65, 2094.34, 1842711111},
  { ~N[2016-04-19 00:00:00], 2096.05, 2104.05, 2091.68, 2100.8, 2164905556},
  { ~N[2016-04-20 00:00:00], 2101.52, 2111.05, 2096.32, 2102.4, 2324933333},
  { ~N[2016-04-21 00:00:00], 2102.09, 2103.78, 2088.52, 2091.48, 2319605556},
  { ~N[2016-04-22 00:00:00], 2091.49, 2094.32, 2081.2, 2091.58, 2105877778},
  { ~N[2016-04-25 00:00:00], 2089.37, 2089.37, 2077.52, 2087.79, 1844300000},
  { ~N[2016-04-26 00:00:00], 2089.84, 2096.87, 2085.8, 2091.7, 1976216667},
  { ~N[2016-04-27 00:00:00], 2092.33, 2099.89, 2082.31, 2095.15, 2277838889},
  { ~N[2016-04-28 00:00:00], 2090.93, 2099.3, 2071.62, 2075.81, 2394355556},
  { ~N[2016-04-29 00:00:00], 2071.82, 2073.85, 2052.28, 2065.3, 2613733333},
  { ~N[2016-05-02 00:00:00], 2067.17, 2083.42, 2066.11, 2081.43, 2133950000},
  { ~N[2016-05-03 00:00:00], 2077.18, 2077.18, 2054.89, 2063.37, 2318550000},
  { ~N[2016-05-04 00:00:00], 2060.3, 2060.3, 2045.55, 2051.12, 2254755556},
  { ~N[2016-05-05 00:00:00], 2052.95, 2060.23, 2045.77, 2050.63, 2226961111},
  { ~N[2016-05-06 00:00:00], 2047.77, 2057.72, 2039.45, 2057.14, 2109083333},
  { ~N[2016-05-09 00:00:00], 2057.55, 2064.15, 2054.31, 2058.69, 2104788889},
  { ~N[2016-05-10 00:00:00], 2062.63, 2084.87, 2062.63, 2084.39, 2000111111},
  { ~N[2016-05-11 00:00:00], 2083.29, 2083.29, 2064.46, 2064.46, 2123322222},
  { ~N[2016-05-12 00:00:00], 2067.17, 2073.99, 2053.13, 2064.11, 2101327778},
  { ~N[2016-05-13 00:00:00], 2062.5, 2066.79, 2043.13, 2046.61, 1988822222},
  { ~N[2016-05-16 00:00:00], 2046.53, 2071.88, 2046.53, 2066.66, 1945200000},
  { ~N[2016-05-17 00:00:00], 2065.04, 2065.69, 2040.82, 2047.21, 2282755556},
  { ~N[2016-05-18 00:00:00], 2044.38, 2060.61, 2034.49, 2047.63, 2278511111},
  { ~N[2016-05-19 00:00:00], 2044.21, 2044.21, 2025.91, 2040.04, 2137094444},
  { ~N[2016-05-20 00:00:00], 2041.88, 2058.35, 2041.88, 2052.32, 1948694444},
  { ~N[2016-05-23 00:00:00], 2052.23, 2055.58, 2047.26, 2048.04, 1697488889},
  { ~N[2016-05-24 00:00:00], 2052.65, 2079.67, 2052.65, 2076.06, 2015188889},
  { ~N[2016-05-25 00:00:00], 2078.93, 2094.73, 2078.93, 2090.54, 2143977778},
  { ~N[2016-05-26 00:00:00], 2091.44, 2094.3, 2087.08, 2090.1, 1794994444}
]

dataset = Dataset.new( data, ["Date", "Open", "High", "Low", "Close", "Volume"])

alias Contex.OHLC.MA

opts = [
  mapping: %{ datetime: "Date", open: "Open", high: "High", low: "Low", close: "Close"},
  style: :candle,
  title: "SPX",
  zoom: 3,
  bull_color: "00FF77",
  bear_color: "FF3333",
  shadow_color: "000000",
  crisp_edges: true,
  body_border: true,
  timeframe: Contex.TimeScale.timeframe_d1(),
  overlays: [
    MA.new( period: 5, color: "0000AA", width: 2)
  ]
]

Contex.Plot.new( dataset, Contex.OHLC, 1200, 800, opts)
|> Contex.Plot.titles( "D1 Candlestick Chart", nil)
